(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[593],{304:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/appointment",function(){return n(620)}])},620:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var o=n(5893),s=n(8356),l=n(3100),i=n(204),a=n(654),r=n(3863),c=n(5322),d=n(8129),u=n(9222),g=n(7294);let h=()=>{let[e,t]=(0,g.useState)({loaded:!1,coordinates:{lat:0,lng:0}}),n=e=>{t({loaded:!0,coordinates:{lat:e.coords.latitude,lng:e.coords.longitude}})},o=e=>{t({loaded:!0,error:e})};return(0,g.useEffect)(()=>{"geolocation"in navigator||o({code:0,message:"Geolocation not supported"}),navigator.geolocation.getCurrentPosition(n,o)},[]),e};var f=n(7536),w=n(898),m=n(1367),x=n(9337),p=n(6076);let _=(0,w.PZ)(),j=m.Mt,k=()=>{let e={lat:37.566826,lng:126.9786567},[t,n]=["0x7eB20590eF39cea2041B7570233607f15da82a3b","sender"],{loaded:w,coordinates:m,error:k}=h(),[v,S]=(0,g.useState)(e),[E,b]=(0,g.useState)(e),[y,N]=(0,g.useState)(""),{register:C,handleSubmit:A}=(0,f.cI)();(0,g.useEffect)(()=>{!w||k||(S(m),b(m),P(m))},[w]);let P=e=>{let{lat:t,lng:n}=e,o=new kakao.maps.services.Geocoder;null==o||o.coord2Address(n,t,(e,t)=>{if(t===kakao.maps.services.Status.OK){let{address:{address_name:t}}=e[0];console.log(t),N(t)}})},z=e=>{e.location=y,e.sender=n,e.receiver=t,console.log(e),I(y,t,e.time)},I=async(e,t,n)=>{let{ethereum:o}=window;o&&o.request||alert("Please install MetaMask!");let s=await o.request({method:"eth_requestAccounts"});0!==s.length?(s[0],L(e,t,n)):console.log("No Authrized Account.")};async function L(e,t,n){try{let{ethereum:o}=window;if(o){let s=new x.Q(o),l=s.getSigner(),i=new p.CH(_,j,l),a=await i.createAppointment(t,e,n,n);await a.wait()}else console.log("Ether obj not exists")}catch(e){console.log(e)}}return(0,o.jsx)(l.xu,{w:"100%",children:(0,o.jsx)("form",{onSubmit:A(e=>z(e)),children:(0,o.jsxs)(i.k,{justifyContent:"center",alignItems:"center",flexDir:"column",h:"90vh",children:[(0,o.jsx)(s.D5,{center:v,style:{width:"50%",height:"500px",borderRadius:"5px"},onClick:(e,t)=>{let n=t.latLng.getLat(),o=t.latLng.getLng();b({lat:n,lng:o}),P({lat:n,lng:o})},children:(0,o.jsx)(s.O_,{position:E})}),(0,o.jsx)(l.xu,{mt:"2",fontSize:"xl",children:y||"서울 중구 태평로1가 31"}),(0,o.jsx)(a.NI,{w:"50%",mt:"5",children:(0,o.jsxs)(r.B,{children:[(0,o.jsx)(c.Ui,{children:"약속 일자"}),(0,o.jsx)(d.I,{placeholder:"Select Date and Time",size:"md",type:"datetime-local",...C("time")})]})}),(0,o.jsx)(u.z,{type:"submit",mt:"3",children:"약속 잡기"})]})})})};var v=k}},function(e){e.O(0,[7,182,181,523,774,888,179],function(){return e(e.s=304)}),_N_E=e.O()}]);